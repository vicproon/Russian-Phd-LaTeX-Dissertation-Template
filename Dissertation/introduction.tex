\chapter*{Введение}							% Заголовок
\addcontentsline{toc}{chapter}{Введение}	% Добавляем его в оглавление

\newcommand{\actuality}{{\textbf\actualityTXT}}
\newcommand{\progress}{}
\newcommand{\actualityandprogress}{\textbf{\actualityandprogressTXT}}
\newcommand{\aim}{{\textbf\aimTXT}}
\newcommand{\tasks}{\textbf{\tasksTXT}}
\newcommand{\novelty}{\textbf{\noveltyTXT}}
\newcommand{\influence}{\textbf{\influenceTXT}}
\newcommand{\methods}{\textbf{\methodsTXT}}
\newcommand{\defpositions}{\textbf{\defpositionsTXT}}
\newcommand{\reliability}{\textbf{\reliabilityTXT}}
\newcommand{\probation}{\textbf{\probationTXT}}
\newcommand{\contribution}{\textbf{\contributionTXT}}
\newcommand{\publications}{\textbf{\publicationsTXT}}

\input{common/characteristic} % Характеристика работы по структуре во введении и в автореферате не отличается (ГОСТ Р 7.0.11, пункты 5.3.1 и 9.2.1), потому её загружаем из одного и того же внешнего файла, предварительно задав форму выделения некоторым параметрам

\textbf{Объем и структура работы.} Диссертация состоит из~введения, четырёх глав, заключения и~двух приложений.
%% на случай ошибок оставляю исходный кусок на месте, закомментированным
%Полный объём диссертации составляет  \ref*{TotPages}~страницу с~\totalfigures{}~рисунками и~\totaltables{}~таблицами. Список литературы содержит \total{citenum}~наименований.
%
Полный объём диссертации составляет
\formbytotal{TotPages}{страниц}{у}{ы}{}, включая
\formbytotal{totalcount@figure}{рисун}{ок}{ка}{ков} и
\formbytotal{totalcount@table}{таблиц}{у}{ы}{}.   Список литературы содержит  
\formbytotal{citenum}{наименован}{ие}{ия}{ий}.



\begin{comment}
Одна из самых важных задач при восстановлении измерений в задаче компьютерной томографии --- избежать появления артефактов.
Ошибки восстановления могут привести к неправильным дальнейшим применениям измеренных объектов
Ошибки возникают на всех этапах формирования томографии, начиная с физических калибровок в аппаратной части и кончая ошибками в визуализации результата.
При разработке ПО для томографа, нужно иметь в виду как возможные причины ошибок, так и специфику задачи, для которой применяется томограф.




\todo{дальше как такового введения нет, идут планы и введения из статей, как наработки для копирования текста.}

1. + что такое томография - позволяет без разрушения восстановить внутреннюю структуру в ppt посмотри о видах томографии	

2. + что такое томограф - это аппаратно-программный комплекс, ты будешь в диссере рассматривать проблемы, возникающие в программной части

3. + из Лешиных тезисов - разные объекты требуют разного при реконструкции - отсюда разное качество реконструкции при использовании разных методов реконструкции
  
4. + но не только методы формируют ошибки результатов восстановления - анализ других источников

5. + описываем самое простое измерение - параллельная схема, монохроматический пучок - здесь первое короткое описание модели формирования сигнала в измерительной схеме

6. приходим к выводу, что алгебраические имеют преимущества над интегральными, поскольку можно учесть и влияние аппаратуры и работать при наличии большого шума
но алгебраические медленные - поэтому надо развивать быстрые реализации, хаф

7. усложним задачу. есть сильнопоглощающие включения - часть ко введению из ecms 2015, icmv 2015 подвести к выводу, что надо создавать и в этом простом для измерения случае (параллельный пучок и монохроматика) принципиально новые методы

8. еще усложним задачу - монохроматику заменим полихроматикой и обретем радости с beam-hardening 2 пути решать - честно или постобработкой измеренных проекций или самой восстановленной картинки.

все это дело объединяем еще раз коротко и выводим актуальность работы.
\end{comment}

\chapter{Современные подходы к решению задачи компьютерной томографии}
\section{Принцип действия томографа}
Опишем основные составные части экспериментальной схемы томографа.
Пример реального экспериментального томографа приведен на рисунке ~\ref{fig:ct_scanner}.

\begin{figure}
\centering
\label{fig:ct_scanner}
\includegraphics[width=0.7\textwidth]{intro_img/ct_scanner_CIRAS}
\caption{Один из ренгеновских томографов ИК РАН}
\end{figure}

Ренгеновское излучение источника, проходя через предварительные фильтры в виде монохроматора и \textbackslash или коллиматора, попадают на объект исследований.
Объект закреплен на вращающейся относительно источника платформе.
Ренгеновское излучение, проходя через объект, поглощается объектом, в результате чего интенсивность излучения ослабляется в соответствии с законом Бугера-Ламберта-Бера:

\begin{equation}
\notag
I = I_0 \exp\left( {-\int \! f(l) \mathrm d l }\right),
\end{equation}

где $l$ -  координата вдоль направления распространения луча, а $f(l)$ - линейный коэффициент ослабления рентгеновского излучения.

Прошедшее через объект излучение затем регистрируется позиционно-чувствительным детектором.
После дискретизации отклика матрицы детектора даные поступают на обработку ПО реконструкции, которое восстанавливает линейный коэффициент ослабления по набору таких измерений объекта под разными углами проекции.
Для того, чтобы понять принцип работы алгоритмов реконструкции, нужно подробнее описать модель формирования измерений.
Проще всего это будет сделать на примере самой простой экспериментальной схемы - экспериментальной схемы с параллельным пучком.

\section{Измерения с параллельным пучком}
Несмотря на свою простоту, схема измерений 2D сечения объекта параллельным пучком рентгеновского излучения является ``ядром'' всех алгоритмов восстановления КТ и имеет много применений на практике.
\todo{правильно ли следующее утверждение?}
Параллельный пучок рентгеновского излучения возникает на синхротроне, в лабораторных условиях при использовании монохраматоров, в результате пересчета измерений в веерной 2D геометрии, которая, в свою очередь, возникает в центральном сечении конуского пучка.
Параллельным пучком может обладать только моохроматическое излучение, чем шире спектр тем сильнее расхождение с моделью параллельного пучка.

\begin{figure}[h!]
  \centering
  \includegraphics[width=0.5\textwidth]{part1_img/experiment}
  \caption{Схема измерений с параллельным пучком (2D)}
  \label{fig:experiment}
\end{figure}

Схема измерений изображена на рис. ~\ref{fig:experiment}.
Единичного измерения характеризуется двумя параметрами: углом поворота объекта и позицией ячейки детектора, к которой данное измерение относится.
Бесконечно тонкий рентгеновский луч, проходящий под углом $\varphi$  через объект на расстоянии $\xi$  от начала координат, описывается выражением
\begin{equation}\notag
  x\cos\varphi + y\sin\varphi = \xi.
\end{equation}
Тогда регистрируемый в пикселе детектора $\xi$ сигнал имеет интенсивность:
\begin{equation}\notag
  I(\varphi, \xi) = I_0 \exp\left( {-\iint \! \mathrm d x \mathrm d y f(x,y)\delta(x\cos\varphi + y\sin\varphi - \xi)}\right).
\end{equation}
Прологарифмировав обе стороны данного выражения, обозначаем измеренные данные как
\begin{equation}\notag
  p(\varphi, \xi) = \ln \left (\frac{I_0}{I(\varphi, \xi)} \right),
\end{equation}
получим преобразование Радона функции $f(x,y)$:
\begin{equation}\notag
  p(\varphi, \xi)= \iint \! \mathrm d x \mathrm d y f(x,y)\delta(x\cos\varphi + y\sin\varphi - \xi).
\end{equation}
Суть задачи реконструкции в томографии --- восстановление двумерной функции сечения объекта ($f(x,\ y)$) по набору ее линейных интегралов вдоль направлений, соответствующих проекционным углам, по набору проекций ($I(\varphi, \xi)$), или обращение преобразования Радона.

\section{Методы восстановления}
Задача восстановления изображения характеристики объекта по набору зарегистрированных проекций является задачей обращения преобразования Радона при условии конечного числа направлений проекции.
Существует два основных подхода к восстановлению измерений компьютерной томографии.

Первая группа методов --- интегральные \cite{herman2013mathematical}  --- подходит к решению задачи обращения преобразования Радона аналитически. 
Основной метод восстановления здесь --- метод свертки и обратной проекции (Filtered Backprojection, FPB) \cite{buzug2008computed}.
В основе этого метода лежит использование теоремы о центральном сечении с применением фильтрации в частотной плоскости.
Применение FBP является стандартом де-факто в компьютерной томографии. 
Вычислительная сложность этого метода определяется сложностью вычисления преобразования фурье изображения, т.е. $O(n^2 \log n)$.
Интегральный, или аналитический, подход работает с измерениями томографа как с непрерывной функцией, явно решая задачу восстановления.
Данная группа методов является вычислительно эффективной, однако может порождать некачественные востановления, содержащие высокий уровень шума и артефакты \cite{Lucas_sota_ir_survey_2015_radiology}.
% дополнить описание FBP формулами

Вторая группа методов --- алгебраические \cite{algebraic_methods}. 
Алгебраические методы пытаются получить характеристику объекта как решение СЛАУ.
При переходе от непрерывных распределений и проекций к дискретным изображениям, преобразование Радона тоже берется в дискретном представлении, и становится преобразованием Хафа \cite{Ginkel04ashort}.
Традиционно считается, что первым методом этого семейства был ART (Algebraic Reconstruction Technique) \cite{GORDON1970471}, в котором авторы применили итерационный метод Качмажа (Kaczmarz) \cite{Kaczmarz1937} решения СЛАУ.
Сам метод Качмажа является частным случаем метода покоординатного спуска или, если речь идет о рандомизированной версии --- стохастического градиенты \cite{Needell2016}.
В зависимости от типа градиентного спуска выделяют разные группы алгебраических методов: SART \cite{sart}, SIRT \cite{GILBERTSIRT}.
В SIRT за один шаг обновления значения переменной используются значения по всем проекционным лучам, в ART --- по одному лучу, в SART --- по всем лучам одного угла проекции.
Так же исследуется выбор наилучшей стратегии релаксации \cite{art_regparam} и перебора проекций \cite{art_pointschoice}.
Уже на этапе моделирования происходит переход к дискретному представлению восстанавливаемой функции, то есть к растровому изображению. 
Итеративная природа данных методов позволяет управлять процессом восстановления, используя регуляризацию и априорные знания об объекте исследования.

Сравнения показывают, что алгебраические методы позволяют достичь лучшего качества восстановления \cite{sirt_less_artifacts, Lucas_sota_ir_survey_2015_radiology}.
Использование итерационных методов восстановления позволяет снизить дозу облучения на 70\% \cite{Willemink2013}.
Так же встречаются гибридные методы, в которых итеративное применение интегрального восстановления используется для улучшения качества восстановленных картин.
Хотя концептуально алгебраические методы проще интегральных и лучше справляются с наличием высокого уровня шума в проекциях, они проигрывают последним по времени реконструкции.
Один из способов ускорить восстановление алгебраических методов --- применение распараллеливания на базе графических процессоров \cite{buz2011cuda}.
Другой возможный способ --- применение асимптотически более эффективных алгоритмов проекции (сложность итерации обычных алгебраических подходов $O(n_\varphi n^2)$).
Один из таких алгоритмов --- быстрое преобразование Хафа (БПХ) \cite{Brady1998, hough}, сложность которого $O(n^2 \log n)$.
Оно основано на использовании особого приближения лучей суммирования, называемого диадическими паттернами.
Форма линии вдоль конкретной суммы получается в результате рекурсивной процедуры по размеру изображения, и отличается от традиционного Брезенхемовского приближения прямой.
Степень отклонения от реальных линий при использовании такого приближения подробно исследуется в работе \cite{ershov2015dyadic}.
Авторам удается теоретически подтвердить эмпирическое наблюдение \cite{Brady1998}, что в худшем случае отклонение диадического паттерна от идеальной линии не превышает $\frac 1 6 \log n$, где $n$ --- линейный размер изображения.
Авторы так же исследуют величину девиации трехмерного БПХ от идеальных плоскостей \cite{ershov3DHough}.

\section{Наличие сильнопоглощающих включений}

Одна из известных проблем при востановлении измерений рентгеновской томографии --- возникновение артефактов, вызванных наличием металических (или других сильнопоглощающих) включений в структуре объекта \cite{barrett2004artifacts, boas2012ct, nasirudin2015reduction, park2015computed}.
Наблюдаемые искажения выглядят как темные полосы между металическими включениями со светлым полосатым ореолом окружающих тканей.
Столкнуться с такими артефактами можно, например, при медицинском сканировании пациента с металлическими коронками в зубах или костными протезами.
Наличие таких артефактов может затруднить нахождение или создать несуществующую потологию при медицинском анализе, скрыть или привнести трещины и полости при промышленных исследованиях.
Причины возникновения таких артефактов различны: ``огрубление луча'' (beam hardening), рассеяние, Пуассоновский шум, движение и краевые эффекты \cite{boas2012ct}.
Так же причиной возникновения таких артефактов является низкое соотношение сигнал-шум прошедшего излучения.
Чтобы избежать появления этих артефактов, используются различные методики: аппаратные, например, автоматическое управление модуляцие тока и напряжения на рентгеновской трубке, и программные, например, предобработка данных адаптивными фильтрами.
Например, в \cite{boas2012ct} используется адаптивное расширение детектирующей ячейки в местах дефицита фотонов.
Еще одна группа методов использует измерения, полученные при зондировании различными энергиями \cite{bamberg2011metal}.
Есть методы, в которых модель формирования синограммы учитывается уже на этапе реконструкции.
Так же для уменьшения артефактов, вызванных металическими включенями используют статистические меторы реконструкции \cite{jmuller2006, buzug2008computed}.
В отлчие от методов на основе свертки и обратной проекции, в таких методах есть возможность независимого взвешивания каждого проекционного луча.
Алгоритмы на основе метода максимального правдоподобия, такие как MLEM \cite{buzug2008computed} и его модифицированная версия $\lambda$-MLEM \cite{oehler2007statistical}, позволяют улучшить качество восстановленного изображения по сравнению с обычной линейной интерполяцией или предположением о пропущенных данных \cite{amirkhanov2012evaluation}.

\begin{comment}

\todo{введение - обзор из статьи аит2013 и бакалаврского диплома}

 Предлагаются новые версии алгоритмов, основанных на алгебраическом подходе, способных работать с сильно зашумлёнными проекциями. Такое условие сформировано необходимостью сокращать время регистрации проекций. Для некоторых применений уменьшение времени регистрации связано с требованием сокращения дозы облучения, для других --- обусловлено высокой динамикой поведения исследуемого объекта. Также следует отметить, что алгебраические методы реконструкции незаменимы, когда речь идет об экспериментах с малым числом проекционных углов и измерениях в ограниченном телесном угле. Только алгебраические методы применимы для решения задач трансмиссионно-эмиссионной томографии, если ослаблением зондирующего и вторичного излучений пренебречь нельзя.




\end{comment}

\section{Учет полихроматического спектра}
Решение задачи томографической реконструкции в условиях полихроматического сканирования \cite{Herman1979bh} до сегодняшнего дня остается актуальной проблемой, несмотря на большое количество исследований, которые ведутся в разных лабораториях мира.
Основные подходы, применяемые сегодня в методе компьютерной томографии, при работе с полихроматическим излучением --- использование двух различающихся спектров для зондирования \cite{graser2009dual, marin_2014_dual_energy_ct}, использование монохроматоров \cite{tan2012beam}, и особая обработка данных с томографа. 
В первом случае в 2 раза увеличивается радиационная нагрузка на объект исследования, что нежелательно при исследовании, например, живых объектов.
Во втором сильно уменьшается интенсивность исходного излучения.
Применение фильтров уменьшает поток квантов в единицу времени, что при ограниченном времени измерения снижает величину регистрируемого сигнала и, соответственно, повышает отношение шум/cигнал. 
Так же чтобы корректно провести фильтрацию, необходимо априорное знание об элементном составе образца, а оно не всегда доступно.

Остальные три подхода, это предобработка данных \cite{dewulf2012sense}, создание алгоритмов реконструкции, в которых полихроматичность заложена в математической модели, используемой при обратном проецировании, и постобработка восстановленных изображений. 
Пост процессинг восстановленного изображения \cite{krumm2008reducing} при использовании в ядре реконструкции полихроматической модели, не позволяет получить количественной информации о восстанавливаемом объекте, даже если визуальное представление сильно улучшается (в смысле показателей критериев, созданных для визуального контроля качества изображений).
Данный подход не может быть использован в таких областях применения компьютерной томографии, в которых от результатов КТ ждут количественной информации.
Это требуется в случаях, когда информация КТ не является конечной целью, а применяется при дальнейших расчетах и исследованиях.
Т.е. свойства исследуемых материалов должны быть описаны количественно.

Второй подход к решению задачи базируется на том, что модель, используемая при обратном проецировании, учитывает эффект полихроматичности.
При этом используются разные приближения \cite{stenner2010dynamic, van2011iterative}.
В работе \cite{brabant2012novel} детально описана процедура реконструкции, она легко применяется к модельным данным, показывает отличные результаты, однако, в ней опущен шаг перехода от нелинейной системы уравнений, которая описывает процесс формирования томографической проекции в полихроматических условиях, к линейной системе, которая потом решается с учетом полихроматичности.
Результаты предварительных исследований показали, что вопрос перехода от нелинейной системы к линейной не является тривиальным, а требует глубокого исследования и описания случаев, для которых при строго соблюденном перечне условий переход вообще является математически корректным.

Наконец, использование предобработки, т.е. коррекции зарегистрированных проекций перед шагом построения синограммы.
Его сильной стороной является тот факт, что если коррекцию удается провести с учетом поглощательных свойств всех включенных в исследуемый объект компонент, то затем можно применять методы реконструкции, созданные для монохроматического зондирования.
Для эффективной реализации такого способа коррекции необходимо создать базу параметров коррекции для типичных классов исследуемых образцов.
Такая база требует постоянного дополнения и перепроверки, с целью дополнительной калибровки корректирующих кривых.
И тем не менее, поскольку часто время реконструкции является важным параметром при создании программного обеспечения, такой процесс подготовки является приемлемым.