\documentclass[12pt]{beamer}
\usepackage[T2A]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[english,russian]{babel}
\usepackage{amssymb,amsfonts,amsmath,mathtext}
\usepackage{cite,enumerate,float,indentfirst}
\usepackage{comment}
\usepackage{animate}

\graphicspath{{../images/}{images/}{../Dissertation/images}} 

% \usetheme[secheader]{Boadilla}
% \usecolortheme{seahorse}

\usetheme{Pittsburgh}
\usecolortheme{whale}

\beamertemplatenavigationsymbolsempty

\newcommand{\todo}{\alert}
\input{../common/data.tex}      % Основные сведения
\input{../common/newnames.tex} 

\setbeamercolor{footline}{fg=blue}
\setbeamertemplate{footline}{
  \leavevmode%
  \hbox{%
  \begin{beamercolorbox}[wd=.333333\paperwidth,ht=2.25ex,dp=1ex,center]{}%
    % И. О. Фамилия, Организация кратко
    \thesisAuthorShort, \thesisOrganizationShort
  \end{beamercolorbox}%
  \begin{beamercolorbox}[wd=.333333\paperwidth,ht=2.25ex,dp=1ex,center]{}%
    % Город, 20XX
    \thesisCity, \thesisYear
  \end{beamercolorbox}%
  \begin{beamercolorbox}[wd=.333333\paperwidth,ht=2.25ex,dp=1ex,right]{}%
  Стр. \insertframenumber{} из \inserttotalframenumber \hspace*{2ex}
  \end{beamercolorbox}}%
  \vskip0pt%
}
\setbeamertemplate{caption}[numbered]

\newcommand{\itemi}{\item[\checkmark]}

\newcommand{\rom}[1]{%
  \textup{\uppercase\expandafter{\romannumeral#1}}%
}

\newcommand\Wider[2][3em]{%
\makebox[\linewidth][c]{%
  \begin{minipage}{\dimexpr\textwidth+#1\relax}
  \raggedright#2
  \end{minipage}%
  }%
}

\AtBeginSection[]{
  \begin{frame}
  \vfill
  \centering
  \begin{beamercolorbox}[sep=8pt,center,shadow=true,rounded=true]{title}
    \usebeamerfont{title}\insertsectionhead\par%
  \end{beamercolorbox}
  \vfill
  \end{frame}
}

%\title{\small{Название презентации}}
\title{\small{\thesisTitle}}

\author{\small{%
\emph{докладчик:}~\thesisAuthorShort\\%
\emph{научный руководитель:}~\supervisorRegaliaShort~\supervisorFioShort}\\%
\vspace{30pt}%
\thesisSpecialtyNumber \ \thesisSpecialtyTitle 
\\
\vspace{30pt}%
\thesisOrganization%
\vspace{20pt}%
}
\date{\small{\thesisCity, \thesisYear}}

\begin{document}

\maketitle

\begin{frame}
\frametitle{Цель работы} % move to 1st slide
Разработка, обоснование и тестирование новых методов реконструкции в задаче компьютерной томографии, их эффективная численная реализация, а также создание метода интерпретации результатов томографического эксперимента в полихроматической моде.
\end{frame}

\begin{comment}
\begin{frame}
\frametitle{Цели работы}
\begin{itemize}
\item разработка и реализация асимптотически быстрых алгебраических методов реконструкции в задаче компьютерной томографии
\item разработка новых алгоритмов для решения задач восстановления при наличии неисключаемых причин ошибок
\item разработка и численное тестирование алгоритмов восстановления в контексте построенных математических моделей
\end{itemize}
\end{frame}
\end{comment}


\begingroup
\footnotesize
\begin{frame}

\frametitle{Положения, выносимые на защиту}
\Wider[5em]{

\begin{enumerate}
  \item Предложен эффективный вычислительный метод решения задачи томографической реконструкции FHT-SIRT, основанный на алгебраическом подходе, который позволяет снизить асимптотическую оценку сложности вычисления итерации с $O(n^3)$ до $O(n^2~\log n)$, что подтвержается численными экспериментами и замерами времени работы программной реализации алгоритма.
  \item Проведено математическое обоснование сходимости предложенного метода.
  \item Предложен метод реконструкции на основе квадратичного программирования, который позволяет уменьшить артефакты на восстановленном изображении, вызванные наличием сильно поглощающих областей в зондируемом объекте.
  \item Предложен алгебраический метод реконструкции для случая полихроматического зондирования, который решает оптимизационную задачу реконструкции относительно линейной комбинации концентраций с ограничениями-неравенствами на их область значений.
\end{enumerate}
}
\end{frame}
\endgroup




\begin{comment}
\begin{frame}
\frametitle{Задачи}

\begin{itemize}
  \item построение асимптотически быстрого алгебраического метода реконструкции, основанного на применении быстрого преобразования Хафа
  \item доказательство сходимости построенного алгебраического метода реконструкции
  \item построение алгоритма реконструкции для объектов, содержащих сильнопоглощающие включения
  \item построение алгоритма реконструкции, учитывающего покомпонентное ослабление полихроматического спектра.
\end{itemize}

\end{frame}
\end{comment}

\begin{frame}
\frametitle{Научная новизна}
\begin{enumerate}
  \item Впервые для реконструкции томографических измерений было применено быстрое преобразование Хафа.
  \item Впервые получено выражение для производной быстрого преобразования Хафа, а так же алгоритм его эффективного вычисления.
  \item Построен алгоритм реконструкции, учитывающий вклад сильно поглощающих включений с помощью оригинальной модели ограничений-неравенств.
  \item Предложена схема обработки данных полихроматического зондирования, при которой восстанавливаются реальные физические концентрации элементов.
\end{enumerate}
\end{frame}


\begin{frame}
\frametitle{Объект исследования}
\textbf{Компьютерная томография} --- 

неразрушающий метод исследования внутренней структуры образцов.
\\ 
Применения:
\begin{itemize}
  \item Контроль качества изготавливаемых изделий
  \item Медицинская диагностика
  \item Использование результатов КТ для дальнейшего моделирования динамических процессов
  \item Биологические и геологические исследования
%  \item Изготовление прототипов (3д-печать) по результатам КТ (?)
\end{itemize}

\end{frame}

\begin{frame}
\frametitle{Объект исследования}
\centering
Томографическое измерение:
\begin{tabular}{p{0.45\textwidth} p{0.55\textwidth}}
  \begin{figure}[H]
    \includegraphics[width=0.45\textwidth]{../Dissertation/images/part1_img/experiment}
  \end{figure}
  &
  \begin{itemize}
  \item $N$ ячеек детектора
  \item $N_\varphi$ углов сканирования
  \item Для каждого угла $\varphi$ и каждой ячейки $s$ измеряется интенсивонсть прошедшего рентгеновского излучения \\
    $\mathrm I \left( \varphi, s \right) = \mathbb P (f(x, y))$
  \end{itemize}
\end{tabular}
\end{frame}

\begingroup
% \small

\begin{frame}
\frametitle{Предмет исследования}
Компьютерная томография --- программно-аппаратный комплекс
% \pause
\setlength{\leftmargini}{0em}
\begin{columns}[T,onlytextwidth]
  \begin{column}{.4\textwidth}
  \begin{itemize}
    \item экспериментальная схема
    \item калибровка 
    \item \textbf{программная обработка $\rightarrow$}
  \end{itemize}
  \end{column}
  \pause
  \begin{column}[t]{0.4\linewidth}
  \begin{itemize}
    \item предобработка
    \item \textbf{алгоритмы восстановления $\rightarrow$}
    \item постобработка
  \end{itemize}
  \end{column}
  \pause
  \begin{column}[t]{0.35\linewidth}
  \begin{itemize}
    \item \textbf{метод оптимизации}
    \item \textbf{модель регуляризации}
    \item \textbf{физическая модель}
    \item реализация математических примитивов
  \end{itemize}
  \end{column}
\end{columns}
\end{frame}
\endgroup

\begin{frame}
\frametitle{Предмет исследования}
\framesubtitle{Предположения}
\begin{itemize}
  \item Рассматривается плоское сечение
  \item Параллельная схема проекции
  \item Ослабление интенсивности излучения подчиняется закону Бугера:
\end{itemize}
  $$
  \mathrm I \left( \varphi, \xi , \lambda \right) = \mathrm I_0(\lambda) \exp\left( {-\int_{l(\varphi, \xi)} \! f(l, \lambda) \mathrm d l }\right),
  $$
  \small
  $f(x, y)$ ---  описывает распределение линейного коэффициента ослабления рентгеновского излучения \\
  $\mathrm I(\varphi, \xi, \lambda)$ --- зарегистрированная детектором интенсивность излучения длины волны $\lambda$ \\
  $\mathrm I_0(\lambda)$ --- интенсивность зондирующего излучения \\
  $l(\varphi, \xi)$ --- параметризация прямой под углом $\varphi$, и сдвигом $\xi$ \\
\end{frame}

\begin{frame}
\frametitle{Задача восстановления}
  Связь линейного коэффициента ослабления и интенсивности описывается преобразованием Радона $R[f(x,y)](\varphi, \xi)$:

  $$
  R[f](\varphi, \xi) = 
 \iint \! \mathrm d x \mathrm d y f(x,y)\delta(x\cos\varphi + y\sin\varphi - \xi)
  $$


  После логарифмирования закона ослабления:
  $$
  \ln \left (\frac{\mathrm I_0(\lambda)}{\mathrm I(\varphi, \xi, \lambda)} \right) = p(\varphi, \xi) = R[f](\varphi, \xi)
  $$

\end{frame}

\begin{frame}
\frametitle{Задача восстановления}
\begin{figure}
\centering
    прямая задача, модель измерения\\
    $\rightarrow$
    \\
    \includegraphics[width=0.8\textwidth]{sl_sinogram}
    \\
    $\leftarrow$ \\
    обратная задача, процедура восстановления
\end{figure}
\end{frame}

% \begin{frame}
% \frametitle{Задача восстановления}
% 
% Задача восстановления функции $f(x,y)$- задача обращения преобразования Радона полученных измерений $p$:
% $$
% f(x,y) = R^{-1}(p(\varphi, \xi))
% $$
% \end{frame}

\begingroup
\small
\begin{frame}
\frametitle{Методы восстановления}
\begin{tabular}{p{0.15\textwidth} | p{0.4\textwidth} | p{0.4\textwidth}}
\hspace{-1cm} семейство & Интегральные & Алгебраические \\ \hline
\hspace{-1cm} подход & Аналитическая формула для обращения $R^{-1}[p(\varphi, \xi)](x,y)$ & Оптимизационная задача $\min_{f} \Norm{R[f] - p}$\\ \hline
\hspace{-1cm} представители & FBP & ART, SART, SIRT \\ \hline
\hspace{-1cm} сложность & $O(N^2 \log N)$ & $O(N^3)$ \\ \hline
\hspace{-1cm} особенности & универсальность & возможность учета \hspace{1cm} модели объекта или измерительной схемы \\
                          & требует полного набора проекционных углов, & \\ 
                          & их равномерного распределения & \\
                          & чувствительны к шумам & \\
\end{tabular}
\\
\vspace{0.5cm}

$N$ --- число ячеек детектора
\end{frame}
\endgroup


\section{Вычислительно эффективный алгебраический метод восстановления FHT-SIRT}

\begin{frame}
\frametitle{Алгебраический метод}
\framesubtitle{Основные положения}
\begin{itemize}
  \item непрерывные функции $\rightarrow$ дискретные изображения:

    {
    \centering
    $f(x,y) \rightarrow f_i,\ p(\varphi, s) \rightarrow p_j$
    \par
    }
  \vspace{0.5cm}
  \item преобразование Радона $\rightarrow$ преобразование Хафа:
  
    {
    \centering
    $R[f](\varphi, s) \rightarrow (\mathrm W f)_j$ 
    \par
    }
  \vspace{0.5cm}

    $\mathrm W$ - матрица проекции, указывает вклад пикселя $i$ в лучевую сумму вдоль луча $j$.
    Разреженная матрица размера $N_\varphi * N^3$, в которой только порядка $O(N_\varphi * N^2)$ ненулевых элементов
    \vspace{0.5cm}
  \item решение разреженной СЛАУ большой размерности итерационным методом

    {
    \centering
    $p = \mathrm W f$
    \par
    }

\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Алгебраический метод}
\framesubtitle{Решение СЛАУ}
\centering
$\Norm{p - \mathrm W f} \rightarrow \min\limits_f$

Оптимизационная задача решается итерационным методом, шаг итерации имеет вид
\vspace{0.5cm}

\begingroup
\footnotesize

\hspace*{-0.5cm}
\begin{tabular}{c|c|c}
ART & SART & SIRT \\ \hline
для каждого луча & для каждого угла & для всех лучей\\
$j = 1 \dots N * N_\varphi$ & $\varphi_k$ & \\
$\hat{f} = f - \gamma \mathrm W^{\mathrm T}_j(\mathrm W f - p)$ &
$\hat{f} = f - \gamma \mathrm {W^{\varphi_k}}^{\mathrm T}(\mathrm W f - p)$ &
$\hat{f} = f - \gamma \mathrm W^{\mathrm T}(\mathrm W f - p)$ \\
\end{tabular}

\vspace{0.5cm}
\raggedright
\endgroup

$\mathrm W_j$ --- столбец матрицы для луча $j$,\\
$\mathrm W^\varphi$ ---  матрица проекции на угол $\varphi$, $\mathrm W = \sum_\varphi {\mathrm W^\varphi}$


\end{frame}

\begin{frame}
\frametitle{Быстрое преобразование Хафа}
\begin{columns}[T,onlytextwidth]
  \hspace*{-0.5cm}
  \begin{column}{0.65\textwidth}
  Приближенный способ вычисления сумм интенсивностей изображения вдоль всевозможных прямых
  \begin{figure}
    \includegraphics[width=1\textwidth]{fht}
  \end{figure}
  \end{column}
  \begin{column}{0.45\textwidth}
  \begin{itemize}
    \item диадические паттерны суммирования
    \item рекурсивная процедура построения
    \item для больших размеров изображения хорошо приближает прямые (отклонение не превышает  $\frac 1 6 \log N$ ) %\cite{ershov2015dyadic})
    \item асимптотическая сложность $N^2 \log N$
  \end{itemize}
  \end{column}
\end{columns}

\end{frame}

\begin{frame}
\frametitle{Быстрое преобразование Хафа}
\frametitle{Процедура формирования диадических паттернов}
  \begin{figure}
  \centering
    \includegraphics[width=1\textwidth]{../Dissertation/images/part1_img/hough_proc}
  \end{figure}
\end{frame}

\begin{frame}
\frametitle{FHT-SIRT}
\framesubtitle{прямая проекция}
\begin{columns}[T,onlytextwidth]
  \hspace*{-0.5cm}
  \begin{column}{0.65\textwidth}
  \begin{figure}
    \includegraphics[width=\textwidth]{../Dissertation/images/part1_img/pattern_structure}
  \end{figure}
  \end{column}
  \begin{column}{0.45\textwidth}
    Углы в БПХ делятся на 4 группы:
    \begin{equation} \notag
    \begin{array}{lll}
    \alpha^\rom{1}_i &= \pi - & \arctan{\frac{N-1-i}{N-1}} \\
    \alpha^\rom{2}_i &= &\arctan{\frac{i - (N-1)}{N-1}} \\
    \alpha^\rom{3}_i &= \frac \pi 2 - & \arctan{\frac{3(N-1)-i}{N-1}} \\
    \alpha^\rom{4}_i &= \frac \pi 2 - & \arctan{\frac{i - 3(N-1)}{N-1}}
    \end{array}
    \end{equation}

    Вычисление прямой проекции в шаге FHT-SIRT имеет вид 
        $\mathrm W = \left( \mathrm  W^\rom{1}\ \mathrm W^\rom{2}\ \mathrm  W^\rom{3}\ \mathrm  W^\rom{4} \right)^{\mathrm T}$.
  \end{column}
\end{columns}
\end{frame}


\begin{frame}
\frametitle{FHT-SIRT}
\framesubtitle{обратная проекция}

\begingroup
\small
\vspace{-0.5cm}
\newtheorem{myth}{Лемма}\
\begin{myth}
Пусть $pattern_j$ --- вертикальный паттерн скоса для j'ой строки преобразования Хафа изображения высотой $M_s = 2^n$.
Тогда имеет место равенство:
\begin{equation} \notag
\label{statement1}
\begin{array}{l l}
pattern_j[i] = pattern_i[j] & \quad  i,j \in \overline{1, 2^n},
\end{array}
\end{equation}
т. е. матрица, составленная из паттернов скоса, записанных в качестве столбцов, симметрична.
\end{myth}
\endgroup
\noindent\rule{8cm}{0.4pt}
\vspace{0.3cm}

Откуда следует, что ${W^{\mathrm K}} ^ {\mathrm T} = W^{\mathrm K}$, а значит
$$
W^{\mathrm T} q = \sum_{K=\rom{1}}^{K=\rom{4}}{W^{\mathrm K} q}
$$

\end{frame}


\begin{frame}
\frametitle{FHT-SIRT}
\framesubtitle{исследование работы}

\begin{columns}[T,onlytextwidth]
  \hspace*{-0.5cm}
  \begin{column}{0.53\textwidth}
    \begin{figure}
      \centering
      \includegraphics[width=\textwidth]{../Dissertation/images/part1_img/time_30_it}
      \caption{Время работы 30 итераций алгоритма}
    \end{figure}
  \end{column}
  \begin{column}{0.6\textwidth}
    \begin{figure}
      \centering
      \includegraphics[width=\textwidth]{../Dissertation/images/part1_img/it_till_stop}
      \caption{количество итераций до останова}
    \end{figure}
  \end{column}
\end{columns}
\end{frame}

\begin{frame}
\frametitle{FHT-SIRT}
\framesubtitle{Предобработка данных}

Перед тем как вести минимизацию с помощью БПХ, необходимо привести измерения в пространство результатов БПХ.
\begin{enumerate}
  \item восстановить соответствие углов проекции строчкам БПХ
  \item растянуть измерения с использованем линейной интерполяции:
\end{enumerate}

\hspace*{2cm}
  \begin{itemize}
    \item \rom{1} растяжение в $\frac 1 {\cos \alpha_i}$ раз
    \item \rom{2} растяжение в $\frac 1 {\cos \alpha_i}$ раз
    \item \rom{3} растяжение в $\frac 1 {\sin \alpha_i}$ раз
    \item \rom{4} растяжение в $\frac 1 {\sin \alpha_i}$ раз
  \end{itemize}

\end{frame}

\begin{frame}
\frametitle{FHT-SIRT}
\framesubtitle{Сходимость при малом количестве углов}
\textbf{Степень разрежения} --- доля отсутствующих углов полного БПХ-пространства
\begin{columns}[T,onlytextwidth]
  \hspace*{-1cm}
  \begin{column}{0.6\textwidth}
  \begin{figure}
    \includegraphics[width=\textwidth]{../Dissertation/images/part1_img/raw}
    \caption{Без регуляризации}
  \end{figure}
  
  \end{column}
  \begin{column}{0.55\textwidth}
    \begin{figure}
    \includegraphics[width=\textwidth]{../Dissertation/images/part1_img/medk}
    \caption{Медианная регуляризация}
    \end{figure}
  \end{column}
\end{columns}
\end{frame}

\begin{frame}
\frametitle{FHT-SIRT}
\framesubtitle{Сходимость при малом количестве углов: медианная регуляризация}

\begin{figure}
\includegraphics[width=0.8\textwidth]{slice_11}
\end{figure}

\end{frame}


\begin{comment}
\begin{frame}
\frametitle{FHT-SIRT}
\framesubtitle{Сходимость при малом количестве углов: регуляризация по Тихонову}

    \begin{figure}
    \includegraphics[width=0.8\textwidth]{tikhonov}
    \end{figure}

\end{frame}
\end{comment}

\begin{frame}
\frametitle{FHT-SIRT}
\framesubtitle{Анимация процесса восстановления}
\begin{columns}[T,onlytextwidth]
\begin{column}{0.4\textwidth}
\animategraphics[loop,controls,width=\linewidth]{10}{anim/frame_}{1}{60}
\end{column}

\begin{column}{0.6\textwidth}
\animategraphics[loop,controls,width=\linewidth]{10}{anim/slice_}{1}{60}
\end{column}
\end{columns}
\end{frame}


% ======================================================
% ================= Сравнение с SART ===================
% ======================================================
\begin{frame}
\frametitle{FHT-SIRT}
\framesubtitle{сравнение с SART}
  \begin{figure}
  \includegraphics[width=0.8\textwidth]{sart__fht_sirt}
  \end{figure}

% \hline
\vspace{1cm}


\small
\begin{tabular}{c|c c}
    метод & SART & FHT-SIRT \\
    количество итераций & 1 & 40 \\
    время & 0.931c & 0.935c \\
    ошибка & 11.8845 & 16.1192 \\
    СКО & 0.3278 & 0.3882 \\
\end{tabular}

\end{frame}


\begin{frame}
\frametitle{FHT-SIRT}
\framesubtitle{сравнение с SART: кросс-секции}
\begin{columns}[T,onlytextwidth]
  \hspace*{-1cm}
  \begin{column}{0.2\textwidth}
    \begin{figure}
      \centering
      \vspace{1.5cm}
      \includegraphics[width=1.5\textwidth]{cs_80_viz}
    \end{figure}
  \end{column}
  \begin{column}{0.8\textwidth}
    \begin{figure}
      \centering
      \vspace{-1cm}
      \includegraphics[width=1.2\textwidth]{cs_80}
    \end{figure}
  \end{column}
\end{columns}
\end{frame}

\begin{frame}
\frametitle{FHT-SIRT}
\framesubtitle{сравнение с SART: кросс-секции}
\begin{columns}[T,onlytextwidth]
  \hspace*{-1cm}
  \begin{column}{0.2\textwidth}
    \begin{figure}
      \centering
      \vspace{1.5cm}
      \includegraphics[width=1.5\textwidth]{cs_127_viz}
    \end{figure}
  \end{column}
  \begin{column}{0.8\textwidth}
    \begin{figure}
      \centering
      \vspace{-1cm}
      \includegraphics[width=1.2\textwidth]{cs_127}
    \end{figure}
  \end{column}
\end{columns}
\end{frame}


\begin{frame}
\frametitle{FHT-SIRT}
\framesubtitle{сравнение с SART: кросс-секции}
\begin{columns}[T,onlytextwidth]
  \hspace*{-1cm}
  \begin{column}{0.2\textwidth}
    \begin{figure}
      \centering
      \vspace{1.5cm}
      \includegraphics[width=1.5\textwidth]{cs_v_50_viz}
    \end{figure}
  \end{column}
  \begin{column}{0.8\textwidth}
    \begin{figure}
      \centering
      \vspace{-1cm}
      \includegraphics[width=1.2\textwidth]{cs_v_50}
    \end{figure}
  \end{column}
\end{columns}
\end{frame}


\section{Подавление артефактов, вызванных наличием сильнопоглощающих включений}

\begin{frame}
\frametitle{Примеры артефактов}

\begin{columns}[t]
\column{.5\textwidth}
\centering
\includegraphics[height=0.5\textheight]{../Dissertation/images/part2_img/tooth_artifacts_med}\\
\includegraphics[height=0.5\textheight]{../Dissertation/images/part2_img/tooth_artifacts_med_2}

\column{.5\textwidth}
\centering
\includegraphics[height=0.5\textheight]{../Dissertation/images/part2_img/tooth_artifacts_med_3}\\
\includegraphics[height=0.5\textheight]{high_absorb_artifacts}
\end{columns}

\end{frame}

\begin{frame}
\frametitle{Модель возникновения артефактов}
  \begin{itemize}[<+->]
    \item при прохождении через сильнопоглощающие включения большая часть излучения поглощается
    \item пиксели детектора имеют некоторый порог активации $\delta_{\mathrm I min}$
    \item если пришедшая интетсивность $\mathrm I_{j} \leq \delta_{\mathrm I min}$, показание детектора будет неотличимо от уровня шума
    \item оптимизационная задача должна учитывать такие измерения особым образом
    \item при логарифмировании условие $\mathrm I_{j} \leq \delta_{\mathrm I min}$ переходит в 
    \begin{equation}
      \label{eq:thresh}
      p_j \geq \delta \left( = \ln \frac {\mathrm I_0}{\delta_{\mathrm I min}}\right)
    \end{equation}
  \end{itemize}
\end{frame}



\begin{frame}
\frametitle{Учет пикселей с высоким поглощением}
Пусть $\mathbb J = \left\{ j | p_j \geq \delta \right\}$, то есть индексы пикселей, для которых выполнено условие (\ref{eq:thresh}).

С учетом пороговой активации, а так же неотрицательности функции $f$, оптимизационная задача будет иметь вид:


\begin{equation} \notag
  % \label{eq:quadprog_ineq}
  \begin{cases}
  \Norm{p - Wf} \rightarrow \min\limits_f & w.r.t \\
  \sum_i f_{i} \omega_{ij} > \delta, & \mbox{если } j \in \mathbb J \\
  f_{i} \geq 0 & \\
  \end{cases}
\end{equation}

\end{frame}


\begin{frame}
\frametitle{Квадратичное программирование}
\begin{itemize}
  \item оптимизация квадратичной функции на наборе линейных ограничений
  \item частный случай выпуклой оптимизации
  \item требует обращения матрицы $W^{\mathrm T} W$. 
  \item для изображения 256х256 и 180 углов при использовании float64 такая матрица будет занимать порядка 32Гб
\end{itemize}


\end{frame}

\begin{frame}
\frametitle{Применение qp для малых размерностей}
\begin{columns}[T,onlytextwidth]
  \hspace*{-1cm}
\begin{column}{0.4\textwidth}
  \begin{figure}
    \centering
    \includegraphics[width=\textwidth]{qp_phantom}
  \end{figure}
  фантом
\end{column}

\begin{column}{0.4\textwidth}
  \begin{figure}
    \centering
    \includegraphics[width=\textwidth]{qp_fbp}
  \end{figure}
  matlab iradon (fpb)
\end{column}

\begin{column}{0.4\textwidth}
    \begin{figure}
    \centering
    \includegraphics[width=\textwidth]{qp_qp_ineq}
  \end{figure}
  QP с ограничениями-неравенствами
\end{column}
\end{columns}

\end{frame}

\begingroup
\small
\begin{frame}
  \frametitle{Как повысить разрешение?}
  \begin{columns}[T, onlytextwidth]
  \hspace{-0.5cm}
  \begin{column}{0.5\textwidth}
    \underline{Метод мягких неравенств} \\ \vspace{0.5cm}
    Введем диагональную матрицу $\mathrm J \in \textup{diag}\{N N_\varphi\}$, такую что 
    $\mathrm J_{j} = \left\{1, \mbox{если}\ j \in \mathbb J, \mbox{иначе }\ 0\right\}$, а так же $\mathrm K = \mathrm E - \mathrm J$.


    \begin{equation} \notag
      \label{eq:soft-ineq}
      \begin{array}{lc}
      \Norm{K(Wf - p)}^2 & + \\
      \alpha \Norm{J(Wf - \delta)}^2  & \to \min\limits_f
      \end{array}
    \end{equation}
  \end{column}

  \begin{column}{0.5\textwidth}
    \underline{Метод барьерных функций} \\ \vspace{0.5cm}
    Заменим неравенства вида $g(x) \leq 0$ на аддитивные барьерные функции $-\frac 1 t \log{\left(-g(x)\right)}$.
    Начиная из ``внутренней''точки, будем минимизировать функционал, постепенно увеличивая t.
    $$
    \begin{array}{ccc}
      F_t(f) = & \Norm{Wf - p}^2 & + \\
     \frac 1 t \sum \left( -\log{\left(-g(x)\right)} \right) &\to \min\limits_f &
    \end{array}{ccc}
    $$

    Так же возможно ввести ослабить ограничения, добавив переменные нежесткости $\xi$

  \end{column}
  \end{columns}
\end{frame}
\endgroup

\begin{frame}
\frametitle{Метод мягких неравенств}
\framesubtitle{фантом}

\begin{figure}
  \centering
  \vspace{-0.3cm}
  \includegraphics[height=0.7\textheight]{qp_foursome}
  \caption{сравнение реконструкции различными методами}
  \label{fig:sample}
\end{figure}

\end{frame}


\begin{frame}
\frametitle{Метод мягких неравенств}
\framesubtitle{другая палитра}

\begin{figure}
  \centering
  \vspace{-0.3cm}
  \includegraphics[height=0.7\textheight]{qp_foursome_pink}
  \caption{сравнение реконструкции различными методами}
  \label{fig:sample}
\end{figure}

\end{frame}

\begin{frame}
\frametitle{Метод мягких неравенств}
\framesubtitle{реконструкция экспериментальных данных}

\begin{figure}
\centering
\vspace{-0.3cm}
\begin{tabular}{@{}c@{}c}
    \includegraphics[width=0.50\textwidth]{../Dissertation/images/part2_img/tooth_sino}
&
    \includegraphics[width=0.50\textwidth]{../Dissertation/images/part2_img/soft_ineq_pb_tooth}
\\
   \small a) & \small b)
\end{tabular}
  \caption{a --- Синограмма молочного зуба с включением из свинца. б --- результат восстановления методом мягких ограничений}
\label{fig:tooth_sino_rec}
\end{figure}

\end{frame}

\section{Задача реконструкции при зондировании полихроматическим излучением}

\begingroup
\small
\begin{frame}
\frametitle{Модель измерений}

При переходе к немонохроматическому случаю, уравнение затухания прошедшей через объект интенсивности: 
\begin{equation}
\notag
I(\varphi, \xi) = \int_0^{+\infty}{\left\{
  I_0(\lambda) \exp{\left(- {\mathrm R}[f(\lambda)](\varphi, \xi) \right)} d\lambda
  \right\}}  
\end{equation}


Будем считать, что объект состоит из $K$ элементов, с неизвестными пространственными концентрациями $c_k(x,y)$, и известными табулированными массовыми коэффициентами ослабления $\kappa_k(\lambda)$.
Тогда
$$
f(x,y, \lambda) = \sum_{k = 1} ^K {c_k(x,y) * \kappa_k(\lambda)}
$$

и прямая проекция для пикселя $j$ принимает вид

\begin{equation} \notag
  \label{eq:white_fp_final}
  I(c)_j = \int_0^{+\infty} {d\lambda \left\{
    I_0(\lambda) \exp{\left(
      -\sum_{k=1}^K {\rho \kappa_k(\lambda) (W c_k)_j} 
      \right)}
  \right\}}
\end{equation}

\end{frame}
\endgroup

\begin{frame}
\frametitle{Оптимизационная задача}

Следуя алгебраическому подходу, реконструкция проводится с помощью градиентного спуска оптимизации квадратичной функции потерь 
$$
Q(c) = \frac {\left(I(c) - t\right)^2} {S} \to \min \limits_c,
$$
где $t$ --- измеренные интенсивности прошедшего через объект излучения, \\
$S = \int_0^{+\infty} { I_0(\lambda) d\lambda}$
 --- суммарная интенсивность зондирующего излучения.

\end{frame}

\begin{frame}
\frametitle{Градиент функции потерь}
\begin{equation} \notag
\label{eq:part3_whitegrad}
  \nabla_k \ Q = 2W^\intercal R_k \text{, где } R_{kj} = \frac {(I(c) - t)_j} {S} \mu_{kj}
\end{equation}

а формулы для вычисления весов невязок по каждому элементу приведены ниже:
\begin{equation} \notag
  \label{eq:weights}
  \mu_{k} = \int_0^{+\infty} {d\lambda \left\{
    -\rho \kappa_k(\lambda) 
    I_0(\lambda)
    \exp{\left(
      -\sum_{s=1}^K {\rho \kappa_s(\lambda) (W c_s)} 
         \right)}
    \right\}}
\end{equation}

\end{frame}


\begin{frame}
\frametitle{Метод взвешенных невязок}
\framesubtitle{регуляризация}
  \begin{block}{Мультипликативная регуляризация}
    Запрещаем одновременное нахождение разных элементов в одном пикселе, т.е. $c_{k} \odot c_{s} = 0 \mbox{, если} k \neq s$.

    $$
    Q(c) + \beta\sum_{k_1 != k_2}\Norm{c_{k_1} \odot c_{k_2}} \to \min \limits_c
    $$
  \end{block}
  \begin{block}{Ограничение на значения концентраций}
  Используя метод барьерных функций, можем учесть, что концентрации имеют значения на интервале $[0, 1]$
    $$
    \begin{array}{lc}
    Q(c) \to \min \limits_c & w.r.t \\
    c_k \geq 0 & \\
    c_k \leq 1
    \end{array}
    $$
  \end{block}
\end{frame}

\begin{frame}
\frametitle{Исходные данные}
\begin{figure}
\centering
\includegraphics[width=\textwidth]{0999}
\\
\caption{фантом на тривиальных спектрах}
\end{figure}
\end{frame}


\begin{frame}
\frametitle{Исходные данные}
\begin{figure}

\centering
\includegraphics[height=0.7\textheight]{../Dissertation/images/part3_img/synth_spectre}
\\
\caption{спектры и массовые коэффициенты ослабления элементов}
\end{figure}

\end{frame}

\begin{frame}
\frametitle{Результаты восстановления}
\begin{figure}
\centering
\includegraphics[width=\textwidth]{whiterec_res}
\\
\caption{Метод взвешенных невязок + метод барьерных функуий + мультипликативная регуляризация}
\end{figure}
\end{frame}


\begin{frame}
\frametitle{Результаты работы}
\begin{itemize}
  \item Получено аналитическое выражение для операции транспонированного быстрого преобразования Хафа. 
  \item Доказана теорема о симметричности четверти БПХ, отвечающей одной группе ориентаций лучей. 
  \item Получен метод вычислительно эффективного вычисления транспонированного преобразования.
  \item Построен вычислительно эффективный алгебраический метод восстановления измерений компьютерной томографии на основе БПХ.
  \item Произведена адаптация метода для работы с данными реальных измерений. Изучены свойства пространства БПХ, влияние различной регуляризации на процесс восстановления.
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Результаты работы}
\begin{itemize}
  \item Построен метод восстановления рентгеновской томографии для объектов, содержащих сильнопоглощающие включения. На реальных экспериментальных измерениях проведено исследование метода мягких ограничений и сравнение с методом квадратичного программирования.
  \item Построен алгоритм восстановления томографии в задаче зондирования полихроматическим излучением, основанный на вычиследнии взвешанных невязок по каждому из элементов, входящих в состав исследуемого образца. 
  \item Предложены варианты регуляризации для востановления в полихроматической моде. Разработанный метод восстановления позволяет разделить концентрации компонентов смеси при восстановлении.
\end{itemize}
\end{frame}

\section{Спасибо за внимание!}

\end{document} 
